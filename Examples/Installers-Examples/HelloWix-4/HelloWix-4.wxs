<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     RequiredVersion="3.10.0.0">
  <Product Id="8EA23CD0-1E91-4158-B055-9EF107AA627E"
           Name="HelloWix-4"
           Language="1033"
           Version="1.0.0.0"
           Manufacturer="New Thinking Technologies"
           UpgradeCode="6FAD1568-2F3A-4AB7-879C-E0D6994EDBC4">
    <Package Description="Simple Demo With basic UI and binary assets from Chapter 2"
             Compressed="yes"
             Manufacturer="New Thinking Technologies"
             Keywords="Practice, Installer, MSI"
             Comments="Test MSI Installer HelloWix-4 by NTT"
             InstallerVersion="405"/>

    <!--The minimal UI from WixUIExtension.dll-->
    <!--The UI tags must be children of Product-->
    <!--The UI tags must appear anywhere after tag Package-->
    <UIRef Id="WixUI_Minimal"/>
    <!--<UIRef Id="WixUI_Advanced"/>-->
    <!--<UIRef Id="WWixUI_FeatureTree"/>-->
    <!--<UIRef Id="WixUI_InstallDir"/>-->
    <!--<UIRef Id="WixUI_Mondo"/>-->

    <MediaTemplate EmbedCab="yes"/>
    <Icon Id="product_icon.ico" SourceFile="ntt_logo.ico"/>

    <Directory Id="TARGETDIR"
               Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="DIR_NewThinkingTechnologies"
                   Name="NewThinkingTechnologies">
          <Directory Id="DIR_HelloWix_4"
                     Name="HelloWix-4">
            <Directory Id="ProgramMenuFolder">
              <Directory Id="DIR_NewThinkingTechnologiesShortCutsDir"
                         Name="NewThinkingTechnologiesShortCutsDir">
              </Directory>
            </Directory>
          </Directory>
        </Directory>
      </Directory>
    </Directory>

    <DirectoryRef Id="DIR_HelloWix_4">
      <Component Id="CMP_MAIN_APPLICATION_EXE"
                 Guid="BDDCD075-5CFB-46E9-8408-E6545EC354EB">
        <File Id="FILE_MAIN_APPLICATION_EXE"
              Source="$(var.FilePath)/HelloWixTetsApp1.exe"              
              Hidden="no"
              ReadOnly="no"
              Vital="yes"
              KeyPath="yes">
        </File>
      </Component>
      <Component Id="CMP_MAIN_APPLICATION_EXE_CONFIG"
                   Guid="681D27C6-AA50-4B39-B9D7-B2FF5139B2EB">
        <File Id="FILE_MAIN_APPLICATION_EXE_CONFIG"
              Source="$(var.FilePath)/HelloWixTetsApp1.exe.config"              
              Hidden="no"
              ReadOnly="no"
              Vital="yes"
              KeyPath="yes">
        </File>
      </Component>
      <Component Id="CMP_MAIN_APPLICATION_MAIN_DLL"
                     Guid="D3466029-98C0-4A78-9CB0-8A154BC2A081">
        <File Id="FILE_MAIN_APPLICATION_MAIN_DLL"
              Source="$(var.FilePath)/HelloWixTestLib1.dll"              
              Hidden="no"
              ReadOnly="no"
              Vital="yes"
              KeyPath="yes">
        </File>
      </Component>
      <Component Id="CMP_MAIN_APPLICATION_DOCUMENTATION"
                   Guid="DE2C58BB-C399-4C7B-920E-898BDD38F751">
        <File Id="FILE_MAIN_APPLICATION_DOCUMENTATION"
              Source="$(var.FilePath)/MainAppDoc.txt"
              Name="Documentation.txt"
              KeyPath="yes">
        </File>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="DIR_NewThinkingTechnologiesShortCutsDir">
      <Component Id="CMP_APPLICATION_SHORTCUTS"
                 Guid="424BB8B7-BA70-4F27-9E32-ACF1CD348929">
        <Shortcut Id="SHORTCUT_MAIN_APPLICATION_EXE"
                  Name="HelloWix-4 Main Product Launch"
                  Description="HelloWix-4 Launch"
                  Target="[DIR_HelloWix_4]HelloWixTetsApp1.exe"
                  Icon="product_icon.ico"/>
        <Shortcut Id="SHORTCUT_MAIN_APPLICATION_DOCS"
                  Name="HelloWix-4 Documentation"
                  Description="HelloWix-4 Documentation"
                  Target="[DIR_HelloWix_4]Documentation.txt"
                  Icon="product_icon.ico"/>
        <Shortcut Id="SHORTCUT_UNISTALL"
                    Name="Uninstall HelloWix-4"
                    Description="Uninstall HelloWix-4 and all its components"
                    Target="[System64Folder]msiexec.exe"
                    Arguments="/x [ProductCode]"
                    Icon="product_icon.ico"/>
        <RemoveFolder Id="RemoveNewThinkingTechnologiesShortCutsDir"
                        On="uninstall"/>
        <RegistryValue Root="HKCU"
                         KeyPath="yes"
                         Key="Software\Microsoft\NewThinkingTechnologies"
                         Name="installed"
                         Type="integer"
                         Value="1"/>
      </Component>
    </DirectoryRef>
    <Feature Id="MainProduct"
             Title="Main Product"
             Description="Installs the Main Feature and Shortcuts"
             Level="1">
      <ComponentRef Id="CMP_MAIN_APPLICATION_EXE"/>
      <ComponentRef Id="CMP_MAIN_APPLICATION_EXE_CONFIG"/>
      <ComponentRef Id="CMP_MAIN_APPLICATION_MAIN_DLL"/>
      <ComponentRef Id="CMP_MAIN_APPLICATION_DOCUMENTATION"/>
      <ComponentRef Id="CMP_APPLICATION_SHORTCUTS"/>
    </Feature>
  </Product>
</Wix>
